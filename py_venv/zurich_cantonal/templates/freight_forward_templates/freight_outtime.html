{%extends "base.html" %}
{% load static %}
{%block content%}
<link href="http://192.168.132.12/rewamp/public/Date/styles/kendo.common.min.css" rel="stylesheet" />
<link href="http://192.168.132.12/rewamp/public/Date/styles/kendo.default.min.css" rel="stylesheet" />
<script type="text/javascript" src="http://192.168.132.12/rewamp/assets/lib/jquery-1.10.1.min.js"></script>
<script src="http://192.168.132.12/rewamp/public/Date/js/kendo.all.min.js"></script>

<script src="http://192.168.132.12/rewamp/public/scripts/form_fields_validadtion.js"></script>

<link rel="stylesheet" href="{% static 'jquery/jquery.datetimepicker.css'%}">
<script src="{% static 'jquery/jquery.datetimepicker.full.js' %}"></script>
<!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"> -->
  <script src="{{CI_BASE_URL}}public/js/jquery.datetimepicker.full.js"></script>
  <link href="{{CI_BASE_URL}}public/js/jquery.datetimepicker.css" rel="stylesheet"/></script>

<script src="{% static 'js/select2.min.js'%}"></script>
<link rel="stylesheet" href="{% static 'css/select2.min.css'%}"  />
  
<script>
  $(document).ready(function (){
    $('.searchselect').select2();
    $(".timeselect").kendoTimePicker({format: "HH:mm ",interval:"5",value:"HH:mm"});
  // $(".dateselect").datetimepicker({
  //     format: "d-m-Y",
  //     timepicker: false
  // });
  $(".dateselect").datetimepicker({
      format: "d-m-Y",
      timepicker: false
  });
  var total_cnt=$("#total_cnt").val();
  // for(var i=1; i<= total_cnt; i++){    
  //   $("#outtime"+i).change(function(){
  //     var  otvalue=$("#outtime"+i).val();
  //     if(otvalue != ''){
  //       alert(otvalue);
  //     }

            

  //   });

  // }
  
  // var table = $('#tableexample_test_2').DataTable( {
  //   responsive: true,scrollY:"400px",scrollX:true,scrollCollapse: false,
  //   fixedColumns:   {
  //       heightMatch: 'none'
  //   }
  // });
  // new $.fn.dataTable.FixedHeader( table );
  

});

function isReadonlyField(evt)
{
    var charCode=(evt.which)?evt.which:event.keyCode;
    if(charCode==9 ){
      return true;
    }
    return false;
    
}
function isNumerickey(evt)
{
    var charCode=(evt.which)?evt.which:event.keyCode;
    if(charCode!=46 && charCode>31 && (charCode<48 || charCode>57) || charCode== 13){
        return false;
    }
    return true;
}
  function isNumerickey0_9(evt)
  {
      var charCode=(evt.which)?evt.which:event.keyCode;
      if(charCode>47 && charCode<58 ){
          return true;
      }
      return false;
  }

  function numerictoTimeEvaluate(id)
  {
    var otval= document.getElementById('outtime'+id).value;
    var otval2=otval.length;
    if (otval2 == 3 ){
      let ot_min=otval.slice(1,3);
      let ot_h=otval.slice(0,1);
     if(ot_h <= 23 && ot_min <=59){     document.getElementById('outtime'+id).value=ot_h+':'+ot_min;      }
     else{  alert('Please enter Hours 0 to 23 and minutes 0 to 59 '); }
    }

    if (otval2 == 4 ){
      let ot_min=otval.slice(2,4);
      let ot_h=otval.slice(0,2);
     if(ot_h <= 23 && ot_min <=59){     document.getElementById('outtime'+id).value=ot_h+':'+ot_min;      }
     else{  alert('Please enter Hours 0 to 23 and minutes 0 to 59 '); }
    }

    // document.getElementById('outtime'+id).innerHTML=otval
      // alert(otval2)
  }
</script>


<style>
  .medha_headings{    color: #800080 !important;    font-weight: 700;  }
  .widthselect{  width: 29%;  margin-right:0.5%;  }
  #myTable td {    margin:1%;    width: 200px !important;    white-space: nowrap;    padding-left: 10px; }
  textarea{border-radius: 5px;}
  input,textarea,select{      border-radius: 5px 5px 5px 5px;      border: 1px solid gray;      padding: 2px;    }
  select{width: 150px;}
</style>
{%comment%}<h1> Hello welcome to {%for emp in emp_names%}{%if emp.empcode == user_id%}{{emp.empname}}{%endif%}{%endfor%}</h1> {%endcomment%}
<div class="row col-12 p-0 m-0 g-0">
  <form method="POST" id="form1" action="freight_outtime">{% csrf_token %}
     
    <fieldset class="border p-2">
      <legend  class="float-none w-auto m-0 p-2 medha_headings fs-5 " >Freight Forword Search</legend>         
        <table id="myTable">                      
          <tbody>
            <tr>
              <td class="px-2 mx-1">Freight ID :                 
                <input type="text" name="fid" id="fid" class="text-uppercase" placeholder="frieght id " onkeypress="return isNumerickey(event)"></td>
              <td class="px-2 mx-1">Vehicle NO :                 
                <input type="text" name="vehicleno" id="vehicleno" class="text-uppercase" placeholder="APXX TRXXXX " ></td>
              <td class="px-1 mx-1">From Date :                 
                <input type="text" name="fromdate" id="fromdate" class="dateselect" placeholder=" DD-MM-YYYY" onkeypress="return isReadonlyField(event)"></td>
              <td class="px-1 mx-1">To Date : 
                <input type="text" name="todate" id="todate" class="dateselect" placeholder=" DD-MM-YYYY" onkeypress="return isReadonlyField(event)"></td>
              <td class="px-1 mx-1">DC No : 
                <input type="text" name="dc_no" id="dc_no" class="text-uppercase"></td>
                           
              <td class="px-1 mx-1">VendorName :   
                             
                <select name="vendorname" id="vendorname_1" class="w-80 searchselect"><option value="">--select vendor--</option>
                {%for vendor in vendor_list%}<option value="{{vendor.ven_id}}">{{vendor.vendor}}</option>{%endfor%}</select></td>            
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>Goods By :<select name="goods_by" id="goods_by_1" class="width10 px-2 my-2"><option value="">-select-</option><option value="By Hand">By Hand</option><option value="By Courier">By Courier</option><option value="By Vehicle">By Vehicle</option><option value="Dispatch">Dispatch</option></select></td>            
                                       
              <td>Freight Name : <select name="freight_name" id="freight_name" class="w-80 searchselect"><option value="">--select Freight Forwarder--</option>
                {%for courier in courier_list%}<option value="{{courier.cid}}">{{courier.courier_name}}</option>{%endfor%}</select></td>              
            
              <td><input type="submit" value="submit" class="m-2 px-2 btn btn-primary fs-5 bolder"></td>              
              <td><a href="{%url 'freight_index'%}">Goods Movement Register</a></td>              
            </tr>
          </tbody>          
        </table> 
        
    </fieldset>
  </form>


  <fieldset class="border p-2">
    <legend  class="float-none w-auto m-0 p-2 medha_headings fs-5 " >Freight Out Time </legend>
    <!-- <form action="{%url 'update_freight'%}" method="post"> {% csrf_token %} -->
      <!-- <input type="submit" value="Update" class="p-1 btn btn-primary m-0"> -->
     
      <span style="font-size: 15px;padding-left: 10px;">By Hand : <span style="color: blue;padding-left: 5px;font-size: 15px;font-weight: 700;">{{byhand}}</span></span>
      <span style="font-size: 15px;padding-left: 10px;">By Courier : <span style="color: blue;padding-left: 5px;font-size: 15px;font-weight: 700;">{{bycourier}}</span></span>
      <span style="font-size: 15px;padding-left: 10px;">By Vehicle : <span style="color: blue;padding-left: 5px;font-size: 15px;font-weight: 700;">{{byvehicle}}</span></span>
      <span style="font-size: 15px;padding-left: 10px;">By Dispatch : <span style="color: blue;padding-left: 5px;font-size: 15px;font-weight: 700;">{{bydispatch}}</span></span>
      <span style="font-size: 15px;padding-left: 10px;">Total Count : <span style="color: blue;padding-left: 5px;font-size: 15px;font-weight: 700;">{{total_cnt}}</span></span>
      <!-- 'byhand':byhand,'bycourier':bycourier,'byvehicle':byvehicle,'bydispatch':bydispatch -->
      <br>
      <form action="{%url 'freight_outtime_update'%}" method="post"> {% csrf_token %}
        <input type="submit" value="Update" class="p-1 btn btn-primary m-0" >
        <input type="hidden" name="total_cnt" id="total_cnt" value="{{total_cnt}}">
      <table class="table table-striped" id="tableexample_test_2">
        <thead>
          <tr>
            <th>Freight ID</th>
            <th>Datetime</th>
            <th>Vehicle NO</th>
            <th>DC NO</th>
            <th>DC Date</th>
            <th>Vendor Name</th>
            <th>NO Of Items</th>
            <th>No.Of Packs</th>
            <th>Freight Name</th>
            <th>Docket NO</th>
            <th>Docket Date</th>          
            <th>Driver Details</th>          
            <th>Security Empcode</th>
            <th>Remarks</th>
            <th>In Time</th>                       
            <th>Out Time</th>            
          </tr>
        </thead>
        <tbody>
                  
          {%for rep in getreport%}                                     
          <tr>                     
            <td>{{forloop.counter}} - {{rep.fid}} <a href="{%url 'freight_edit' rep.fid %} ">Edit</a></td>
            <td>{{rep.datetime |date:" d - m - Y"}}</td>
            <td>{{rep.vehicleno}} <br><span class="text-primary p-0 m-0"> {%if rep.noof_feet %}NO OF Feets : {{rep.noof_feet}}{%endif%}  </span></td>
            <td>{{rep.dc_no}}</td>
            <td>{{rep.dc_date |date:" d - m - Y"}}</td>
            <td> <span>{%for vendor in vendor_list%}{%if rep.vendorname == vendor.ven_id%}{{vendor.vendor}}{%endif%}{%endfor%}</span>              
                  {%if rep.disp_vend%}{{rep.disp_vend}}{%endif%}
            </td>
            <td>{{rep.noof_items}}</td>
            <td>{{rep.noof_pack}}</td>
            <td>{%for courier in courier_list%}{%if rep.freight_name == courier.cid%}{{courier.courier_name}}{%endif%}{%endfor%}</td>
            <td>{{rep.docket_no}}</td>
            <td>{{rep.docket_date |date:" d - m - Y"}}</td>          
            <td>{{rep.driver_name}} <br> {{rep.driver_mobile}}</td>          
                          
              <td>{{rep.security_empcode}}</td>
              <td>{{rep.remarks}}</td>
              <td>{%if rep.intime%}{{rep.intime}}{%else%} <span style="color:red;">Empty </span>{%endif%}</td>
              <td>                         
                <input type="hidden" name="fid{{forloop.counter}}" id="fid" value="{{rep.fid}}">          
                <input type="text" name="outtime{{forloop.counter}}" id="outtime{{forloop.counter}}" maxlength="4" class=" p-1 my-2 timeselect width15 px-2 my-2" onkeypress="return isNumerickey0_9(event)" placeholder="Out-Time" onchange="return numerictoTimeEvaluate('{{forloop.counter}}')" > 
                
                </td>            
          </tr>
          
          {%endfor%}        
        </tbody>
      </table>
    </form>
       
    
    </fieldset>

    


  
  


  
</div>




 

{%endblock%}

